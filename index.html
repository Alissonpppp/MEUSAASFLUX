<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FluxoBlue Pro</title>
    
    <!-- 1. BIBLIOTECAS (CDN Rápidas) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- 2. CONFIGURAÇÃO VISUAL -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: { 50:'#eff6ff', 100:'#dbeafe', 500:'#3b82f6', 600:'#2563eb', 700:'#1d4ed8', 900:'#1e3a8a' },
                    },
                    fontFamily: { sans: ['Inter', 'system-ui', 'sans-serif'] }
                }
            }
        }
    </script>

    <style>
        body { background: #0f172a; color: #f8fafc; -webkit-tap-highlight-color: transparent; }
        .hidden { display: none !important; }
        .flex { display: flex !important; }
        .fade-in { animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        .glass { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.05); }
        .spinner { width: 24px; height: 24px; border: 3px solid rgba(255,255,255,0.1); border-top-color: #3b82f6; border-radius: 50%; animation: spin 0.8s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        
        #mobile-menu { transition: transform 0.3s ease-in-out; }
        #mobile-menu.closed { transform: translateX(-100%); }
    </style>
</head>
<body class="h-screen flex flex-col overflow-hidden">

    <!-- 1. TELA DE IDENTIFICAÇÃO (Login Local) -->
    <div id="view-auth" class="fixed inset-0 z-50 bg-slate-900 flex items-center justify-center p-6 hidden">
        <div class="w-full max-w-sm glass p-8 rounded-3xl relative">
            <div class="text-center mb-8">
                <div class="inline-flex p-3 rounded-2xl bg-white/5 border border-white/10 mb-4 shadow-xl">
                    <i class="ph-fill ph-user-circle text-4xl text-brand-400"></i>
                </div>
                <h1 class="text-2xl font-bold text-white">Identificação</h1>
                <p class="text-slate-400 text-sm mt-2">Digite seu email para acessar.</p>
            </div>
            <form id="form-login" class="space-y-4">
                <input type="email" id="auth-email" class="w-full p-4 bg-slate-800 rounded-xl text-white outline-none focus:ring-2 focus:ring-brand-500 border border-slate-700 transition-all" placeholder="seu@email.com" required>
                <button type="submit" class="w-full bg-brand-600 hover:bg-brand-500 text-white font-bold py-4 rounded-xl shadow-lg transition-all active:scale-95">Acessar</button>
            </form>
        </div>
    </div>

    <!-- 2. TELA DE BLOQUEIO (Paywall) -->
    <div id="view-paywall" class="fixed inset-0 z-40 bg-slate-900 flex items-center justify-center p-4 hidden">
        <div class="w-full max-w-md glass p-8 rounded-3xl text-center border-t-4 border-t-brand-500 shadow-2xl">
            <div class="mb-4 inline-block p-4 rounded-full bg-brand-500/10 text-brand-400">
                <i class="ph-fill ph-lock-key text-5xl"></i>
            </div>
            <h2 class="text-2xl font-bold text-white mb-2">Licença Necessária</h2>
            <p class="text-slate-400 text-sm mb-6">
                O acesso aos dados deste email está bloqueado. Ative sua licença vitalícia.
            </p>

            <!-- LINK DA CAKTO -->
            <a href="https://pay.cakto.com.br/scbctc9_679715" target="_blank" class="block w-full bg-gradient-to-r from-brand-600 to-purple-600 hover:brightness-110 text-white font-bold py-4 rounded-xl shadow-lg mb-6 active:scale-95 transition-all">
                COMPRAR LICENÇA (R$ 29,90)
            </a>

            <!-- Validação -->
            <div class="bg-slate-800/80 p-5 rounded-2xl border border-slate-700 text-left">
                <p class="text-[10px] text-slate-400 mb-2 uppercase font-bold tracking-wider">Tenho um código:</p>
                <div class="flex gap-2">
                    <input type="text" id="license-input" class="flex-1 p-3 bg-slate-900 border border-slate-600 rounded-lg text-white text-center font-mono placeholder-slate-700 focus:border-brand-500 outline-none uppercase" placeholder="COLE AQUI">
                    <button onclick="window.app.validate()" class="bg-brand-600 hover:bg-brand-500 text-white px-5 rounded-lg font-bold"><i class="ph-bold ph-check"></i></button>
                </div>
                <p id="license-error" class="text-red-400 text-xs mt-3 hidden font-bold flex items-center gap-1"><i class="ph-bold ph-warning"></i> Chave inválida.</p>
            </div>
            
            <button onclick="window.app.logout()" class="mt-8 text-xs text-slate-500 hover:text-white underline">Trocar Email</button>
        </div>
    </div>

    <!-- 3. APP PRINCIPAL -->
    <div id="view-app" class="flex-1 flex overflow-hidden h-screen w-screen hidden bg-slate-900">
        
        <!-- SIDEBAR -->
        <aside id="sidebar" class="hidden md:flex w-72 glass border-r-0 border-r-slate-800 flex-col z-20">
            <div class="p-8 flex items-center gap-3">
                <div class="bg-brand-600 p-2 rounded-lg text-white shadow-lg"><i class="ph-bold ph-wallet text-xl"></i></div>
                <h1 class="font-bold text-xl text-white">Fluxo<span class="text-brand-500">Blue</span></h1>
            </div>
            <nav class="flex-1 px-4 space-y-2">
                <button onclick="window.app.nav('dashboard')" class="nav-btn w-full flex items-center gap-3 px-4 py-3 rounded-xl font-medium text-slate-400 hover:bg-white/5 hover:text-white transition-all active-nav" id="nav-dashboard"><i class="ph-bold ph-squares-four text-xl"></i> Visão Geral</button>
                <button onclick="window.app.nav('transactions')" class="nav-btn w-full flex items-center gap-3 px-4 py-3 rounded-xl font-medium text-slate-400 hover:bg-white/5 hover:text-white transition-all" id="nav-transactions"><i class="ph-bold ph-list-dashes text-xl"></i> Extrato</button>
                <button onclick="window.app.nav('ai')" class="nav-btn w-full flex items-center gap-3 px-4 py-3 rounded-xl font-medium text-slate-400 hover:bg-white/5 hover:text-white transition-all" id="nav-ai"><i class="ph-bold ph-sparkle text-xl text-purple-400"></i> Consultor IA</button>
            </nav>
            <div class="p-6 border-t border-slate-800">
                <div class="flex items-center gap-3 mb-4">
                    <div class="w-10 h-10 rounded-full bg-gradient-to-br from-brand-500 to-purple-600 text-white flex items-center justify-center font-bold">P</div>
                    <div class="overflow-hidden">
                        <p class="text-xs font-bold text-brand-400 uppercase">Premium</p>
                        <p id="user-display" class="text-sm font-bold text-slate-300 truncate">...</p>
                    </div>
                </div>
                <button onclick="window.app.logout()" class="w-full text-red-400 hover:bg-red-500/10 py-2 rounded-lg text-xs font-bold transition-colors">SAIR</button>
            </div>
        </aside>

        <!-- CONTEÚDO -->
        <main class="flex-1 flex flex-col relative overflow-hidden">
            <header class="md:hidden bg-slate-900/90 backdrop-blur-md px-5 py-4 flex justify-between items-center border-b border-slate-800 z-20">
                <button onclick="window.app.toggleMenu()" class="text-slate-400"><i class="ph-bold ph-list text-3xl"></i></button>
                <div class="flex items-center gap-2 text-brand-500"><i class="ph-fill ph-wallet text-2xl"></i><span class="font-bold text-lg text-white">FluxoBlue</span></div>
                <div class="w-8"></div>
            </header>

            <div class="flex-1 overflow-y-auto p-4 md:p-8 pb-32">
                
                <!-- DASHBOARD -->
                <section id="page-dashboard" class="fade-in">
                    <div class="flex justify-between items-end mb-8">
                        <div><h2 class="text-2xl font-bold text-white">Visão Geral</h2><p class="text-slate-400 text-sm">Seu patrimônio em tempo real.</p></div>
                        <button onclick="window.app.openModal()" class="hidden md:flex bg-brand-600 hover:bg-brand-500 text-white px-5 py-2.5 rounded-xl font-bold shadow-lg items-center gap-2"><i class="ph-bold ph-plus-circle text-lg"></i> Novo</button>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <div class="p-6 rounded-2xl bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700 shadow-xl relative overflow-hidden">
                            <div class="relative z-10"><p class="text-xs font-bold uppercase text-slate-400 mb-1">Saldo Total</p><h3 id="val-balance" class="text-3xl font-black text-white">R$ 0,00</h3></div>
                        </div>
                        <div class="p-5 rounded-2xl bg-slate-800/50 border border-slate-700/50 shadow-sm"><p class="text-xs font-bold text-slate-400 uppercase">Receitas</p><h3 id="val-income" class="text-2xl font-bold text-emerald-400">R$ 0,00</h3></div>
                        <div class="p-5 rounded-2xl bg-slate-800/50 border border-slate-700/50 shadow-sm"><p class="text-xs font-bold text-slate-400 uppercase">Despesas</p><h3 id="val-expense" class="text-2xl font-bold text-red-400">R$ 0,00</h3></div>
                    </div>

                    <div class="bg-slate-800/50 p-6 rounded-2xl border border-slate-700/50 mb-6">
                        <h3 class="font-bold text-slate-300 mb-4">Fluxo Mensal</h3>
                        <div class="h-64 relative w-full"><canvas id="financeChart"></canvas></div>
                    </div>

                    <div class="bg-slate-800/50 rounded-2xl border border-slate-700/50 overflow-hidden">
                        <div class="p-5 border-b border-slate-700/50"><h3 class="font-bold text-slate-300 text-sm uppercase">Recentes</h3></div>
                        <div id="list-recent" class="divide-y divide-slate-700/50"><div class="p-8 text-center text-slate-500 text-sm">Carregando...</div></div>
                    </div>
                </section>
                
                <!-- TRANSACTIONS -->
                <section id="page-transactions" class="hidden fade-in">
                    <h2 class="text-2xl font-bold text-white mb-6">Extrato Completo</h2>
                    <div class="bg-slate-800/50 rounded-2xl border border-slate-700/50 overflow-hidden"><div id="list-full" class="divide-y divide-slate-700/50"></div></div>
                </section>

                <!-- IA -->
                <section id="page-ai" class="hidden fade-in">
                    <div class="bg-gradient-to-r from-brand-900 to-slate-900 rounded-3xl p-8 border border-brand-500/30 relative overflow-hidden mb-6">
                        <div class="relative z-10"><h2 class="text-2xl font-bold text-white mb-2 flex items-center gap-2"><i class="ph-fill ph-sparkle text-brand-400"></i> FluxoBlue IA</h2><p class="text-slate-300">Análise inteligente.</p></div>
                    </div>
                    <div id="ai-content" class="space-y-4"></div>
                </section>
            </div>

            <!-- Mobile Nav -->
            <nav class="md:hidden fixed bottom-0 w-full bg-slate-900/90 backdrop-blur border-t border-slate-800 pb-safe pt-2 px-6 flex justify-around items-center h-20 z-30">
                <button onclick="window.app.nav('dashboard')" class="flex flex-col items-center gap-1 text-brand-500"><i class="ph-bold ph-squares-four text-2xl"></i></button>
                <button onclick="window.app.openModal()" class="bg-brand-600 text-white p-4 rounded-full shadow-lg -mt-8 border-4 border-slate-900"><i class="ph-bold ph-plus text-2xl"></i></button>
                <button onclick="window.app.nav('transactions')" class="flex flex-col items-center gap-1 text-slate-500"><i class="ph-bold ph-list-dashes text-2xl"></i></button>
            </nav>
        </main>
    </div>

    <!-- MOBILE MENU OVERLAY -->
    <div id="mobile-menu-overlay" class="fixed inset-0 z-40 bg-slate-900 closed md:hidden flex flex-col w-3/4 shadow-2xl border-r border-slate-800 transition-transform">
        <div class="p-6 border-b border-slate-800 flex justify-between items-center">
            <h2 class="text-xl font-bold text-white flex items-center gap-2"><i class="ph-fill ph-wallet text-brand-500"></i> Menu</h2>
            <button onclick="window.app.toggleMenu()" class="p-2 bg-slate-800 rounded-full text-white"><i class="ph-bold ph-x"></i></button>
        </div>
        <nav class="p-4 space-y-2 flex-1">
            <button onclick="window.app.nav('dashboard')" class="w-full p-4 rounded-xl text-left font-bold text-slate-400 hover:bg-slate-800 hover:text-white flex gap-3"><i class="ph-bold ph-squares-four text-xl"></i> Visão Geral</button>
            <button onclick="window.app.nav('transactions')" class="w-full p-4 rounded-xl text-left font-bold text-slate-400 hover:bg-slate-800 hover:text-white flex gap-3"><i class="ph-bold ph-list-dashes text-xl"></i> Extrato</button>
            <button onclick="window.app.nav('ai')" class="w-full p-4 rounded-xl text-left font-bold text-slate-400 hover:bg-slate-800 hover:text-white flex gap-3"><i class="ph-bold ph-sparkle text-xl text-purple-500"></i> Consultor IA</button>
        </nav>
        <div class="p-6 border-t border-slate-800">
            <button onclick="window.app.resetData()" class="w-full py-3 bg-red-500/10 text-red-500 rounded-xl font-bold text-sm hover:bg-red-500/20">Resetar App</button>
        </div>
    </div>
    <div id="menu-backdrop" onclick="window.app.toggleMenu()" class="fixed inset-0 z-30 bg-black/80 hidden md:hidden"></div>

    <!-- MODAL ADD -->
    <div id="modal-add" class="fixed inset-0 z-50 bg-black/80 hidden items-end md:items-center justify-center backdrop-blur-sm transition-opacity">
        <div class="bg-slate-800 w-full md:max-w-md md:rounded-3xl rounded-t-3xl p-6 border border-slate-700">
            <div class="flex justify-between items-center mb-6"><h3 class="text-xl font-bold text-white">Novo Lançamento</h3><button onclick="window.app.closeModal()" class="text-slate-400 hover:text-white"><i class="ph-bold ph-x text-lg"></i></button></div>
            <form id="form-transaction" class="space-y-4">
                <div class="bg-slate-700/50 p-1 rounded-xl flex"><button type="button" class="type-sel flex-1 py-2.5 rounded-lg text-sm font-bold text-white bg-red-500/20 text-red-400 border border-red-500/50" data-type="expense" onclick="window.app.setType('expense')">Despesa</button><button type="button" class="type-sel flex-1 py-2.5 rounded-lg text-sm font-bold text-slate-400" data-type="income" onclick="window.app.setType('income')">Receita</button></div>
                <input type="number" id="inp-val" step="0.01" class="w-full p-4 bg-slate-900 border border-slate-700 rounded-2xl text-2xl font-bold text-white outline-none focus:border-brand-500" placeholder="0,00" required>
                <input type="text" id="inp-desc" class="w-full p-4 bg-slate-900 border border-slate-700 rounded-2xl text-white outline-none focus:border-brand-500" placeholder="Descrição" required>
                <div class="grid grid-cols-2 gap-4"><select id="inp-cat" class="w-full p-4 bg-slate-900 border border-slate-700 rounded-2xl text-white outline-none"><option>Alimentação</option><option>Transporte</option><option>Lazer</option><option>Moradia</option><option>Saúde</option><option>Salário</option><option>Outros</option></select><input type="date" id="inp-date" class="w-full p-4 bg-slate-900 border border-slate-700 rounded-2xl text-white outline-none" required></div>
                <button type="submit" class="w-full bg-brand-600 hover:bg-brand-500 text-white font-bold py-4 rounded-2xl mt-2">Salvar</button>
            </form>
        </div>
    </div>

    <!-- SCRIPT (LÓGICA LOCAL) -->
    <script>
        const SECRET_SALT = "FLUXO_VIP_2025";
        const DB_KEY = "fluxoblue_v21_data";
        
        // --- FUNÇÕES DE DADOS ---
        const DB = {
            getData: () => JSON.parse(localStorage.getItem(DB_KEY) || '{"user":null,"lic":null,"trans":[]}'),
            save: (data) => localStorage.setItem(DB_KEY, JSON.stringify(data)),
            
            login: (email) => {
                const data = DB.getData();
                data.user = email.trim().toLowerCase();
                DB.save(data);
                location.reload();
            },
            
            setLicense: (key) => {
                const data = DB.getData();
                data.lic = key;
                DB.save(data);
                location.reload();
            },
            
            addTrans: (item) => {
                const data = DB.getData();
                data.trans.unshift({ id: Date.now().toString(), ...item });
                DB.save(data);
                return data.trans;
            },
            
            delTrans: (id) => {
                const data = DB.getData();
                data.trans = data.trans.filter(t => t.id !== id);
                DB.save(data);
                return data.trans;
            },
            
            wipe: () => {
                if(confirm("Deseja resetar tudo?")) {
                    localStorage.removeItem(DB_KEY);
                    location.reload();
                }
            }
        };

        // --- VALIDAÇÃO DE CHAVE ---
        function checkKey(email, key) {
            try {
                const decoded = atob(key).split('|');
                if (decoded.length !== 3) return false;
                const [kEmail, kDate, kSecret] = decoded;
                if (kEmail !== email || kSecret !== SECRET_SALT) return false;
                const today = new Date().toISOString().split('T')[0];
                return today <= kDate;
            } catch { return false; }
        }

        // --- ESTADO GLOBAL ---
        let currentType = 'expense';
        let chartInstance = null;

        // --- INICIALIZAÇÃO ---
        function init() {
            const data = DB.getData();
            
            if (!data.user) {
                document.getElementById('view-auth').classList.remove('hidden');
                return;
            }

            if (data.lic && checkKey(data.user, data.lic)) {
                // Acesso Permitido
                document.getElementById('view-app').classList.remove('hidden');
                document.getElementById('view-app').classList.add('flex');
                document.getElementById('user-email-display').innerText = data.user;
                updateUI();
            } else {
                // Bloqueado
                document.getElementById('paywall-user-name').innerText = data.user;
                document.getElementById('view-paywall').classList.remove('hidden');
            }
            
            document.getElementById('inp-date').valueAsDate = new Date();
            window.app.setType('expense');
        }

        // --- CONTROLES ---
        window.app = {
            nav: (id) => {
                document.querySelectorAll('section[id^="page-"]').forEach(e => e.classList.add('hidden'));
                document.getElementById('page-'+id).classList.remove('hidden');
                // Estilos botões
                document.querySelectorAll('.nav-btn').forEach(b => {
                    b.classList.remove('bg-white/5', 'text-white'); b.classList.add('text-slate-400');
                    if(b.id === 'nav-'+id) { b.classList.add('bg-white/5', 'text-white'); b.classList.remove('text-slate-400'); }
                });
                document.getElementById('mobile-menu').classList.add('closed');
                document.getElementById('menu-backdrop').classList.add('hidden');
            },
            toggleMenu: () => {
                document.getElementById('mobile-menu').classList.toggle('closed');
                document.getElementById('menu-backdrop').classList.toggle('hidden');
            },
            openModal: () => {
                document.getElementById('modal-add').classList.remove('hidden');
                setTimeout(()=>document.getElementById('modal-add').classList.add('flex'), 10);
            },
            closeModal: () => {
                document.getElementById('modal-add').classList.remove('flex');
                document.getElementById('modal-add').classList.add('hidden');
            },
            setType: (t) => {
                currentType = t;
                document.querySelectorAll('.type-sel').forEach(b => {
                    if(b.dataset.type === t) {
                        const cl = t === 'income' ? 'bg-emerald-500/20 text-emerald-400 border-emerald-500/50' : 'bg-red-500/20 text-red-400 border-red-500/50';
                        b.className = `type-sel flex-1 py-2.5 rounded-lg text-sm font-bold shadow-sm transition-all border ${cl}`;
                    } else {
                        b.className = 'type-sel flex-1 py-2.5 rounded-lg text-sm font-bold text-slate-400 bg-slate-800 transition-all border border-transparent';
                    }
                });
            },
            validateLicense: () => {
                const key = document.getElementById('license-input').value.trim();
                const user = DB.getData().user;
                if(checkKey(user, key)) {
                    DB.setLicense(key);
                } else {
                    document.getElementById('license-error').classList.remove('hidden');
                }
            },
            logout: () => {
                const data = DB.getData();
                data.user = null; // Só desloga
                DB.save(data);
                location.reload();
            },
            resetData: () => DB.wipe(),
            deleteTrans: (id) => { if(confirm("Apagar?")) { DB.delTrans(id); updateUI(); } }
        };

        // --- RENDER ---
        const formatBRL = (v) => v.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
        const formatDate = (d) => d ? d.split('-').reverse().join('/') : '--/--';

        function updateUI() {
            const data = DB.getData().trans;
            let inc = 0, exp = 0;
            data.forEach(t => t.type === 'income' ? inc += t.val : exp += t.val);
            
            document.getElementById('val-income').textContent = formatBRL(inc);
            document.getElementById('val-expense').textContent = formatBRL(exp);
            document.getElementById('val-balance').textContent = formatBRL(inc - exp);
            
            renderList(data);
            renderChart(inc, exp);
            renderAI(inc, exp);
        }

        function renderList(data) {
            const listFull = document.getElementById('list-full');
            const listRecent = document.getElementById('list-recent');
            if(!data.length) { listFull.innerHTML = listRecent.innerHTML = '<div class="p-8 text-center text-slate-500 text-sm">Sem dados.</div>'; return; }
            
            const html = data.map(t => {
                const color = t.type === 'income' ? 'text-emerald-400' : 'text-red-400';
                const sign = t.type === 'income' ? '+' : '-';
                return `<div class="flex justify-between items-center p-4 border-b border-slate-700/50 hover:bg-slate-800/50 transition"><div><p class="font-bold text-sm text-slate-200">${t.desc}</p><p class="text-xs text-slate-500">${t.cat} • ${formatDate(t.date)}</p></div><div class="flex items-center gap-3"><span class="font-bold text-sm ${color}">${sign} ${formatBRL(t.val)}</span><button onclick="window.app.deleteTrans('${t.id}')" class="text-slate-600 hover:text-red-400">X</button></div></div>`;
            }).join('');
            
            listFull.innerHTML = html;
            listRecent.innerHTML = html;
        }

        function renderChart(inc, exp) {
            const ctx = document.getElementById('financeChart'); if(!ctx) return;
            if(chartInstance) chartInstance.destroy();
            chartInstance = new Chart(ctx.getContext('2d'), { type: 'bar', data: { labels: ['Entrada', 'Saída'], datasets: [{ label: 'Total', data: [inc, exp], backgroundColor: ['#34d399', '#f87171'], borderRadius: 6 }] }, options: { responsive: true, plugins: { legend: { display: false } }, scales: { y: { display: false }, x: { grid: { display: false } } } } });
        }

        function renderAI(inc, exp) {
            const el = document.getElementById('ai-content');
            if(exp > inc) el.innerHTML = `<div class="bg-red-500/10 border border-red-500/20 p-4 rounded-xl text-red-300 text-sm">Alerta: Déficit de ${formatBRL(exp-inc)}.</div>`;
            else el.innerHTML = `<div class="bg-emerald-500/10 border border-emerald-500/20 p-4 rounded-xl text-emerald-300 text-sm">Positivo! Sobra de ${formatBRL(inc-exp)}.</div>`;
        }

        // --- LISTENERS ---
        document.getElementById('form-login').addEventListener('submit', (e) => {
            e.preventDefault();
            DB.login(document.getElementById('auth-email').value);
        });

        document.getElementById('form-transaction').addEventListener('submit', (e) => {
            e.preventDefault();
            const btn = e.target.querySelector('button'); btn.disabled = true; btn.innerText = "...";
            try {
                DB.addTrans({
                    desc: document.getElementById('inp-desc').value,
                    val: parseFloat(document.getElementById('inp-val').value),
                    cat: document.getElementById('inp-cat').value,
                    date: document.getElementById('inp-date').value,
                    type: currentType
                });
                window.app.closeModal(); e.target.reset(); window.setType('expense'); updateUI();
            } catch(e) { alert(e.message); } finally { btn.disabled = false; btn.innerText = "Salvar"; }
        });

        init();
    </script>
</body>
</html>
